<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="920px" preserveAspectRatio="none" style="width:493px;height:920px;background:#FFFFFF;" version="1.1" viewBox="0 0 493 920" width="493px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="475" x="5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="465" x="10" y="27.9951">Managed Subscribe Sequence from Provider's Perspective</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="93.75" x2="93.75" y1="73.5938" y2="885.0391"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="377.25" x2="377.25" y1="73.5938" y2="885.0391"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="438.25" x2="438.25" y1="73.5938" y2="885.0391"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="17.75" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="24.75" y="62.292">Digital Twin Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="17.75" y="884.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="24.75" y="904.0342">Digital Twin Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="357.25" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="364.25" y="62.292">Ibeji</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="357.25" y="884.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="364.25" y="904.0342">Ibeji</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="408.25" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="415.25" y="62.292">Broker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60" x="408.25" y="884.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="415.25" y="904.0342">Broker</text><polygon fill="#181818" points="365.75,100.7266,375.75,104.7266,365.75,108.7266,369.75,104.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="93.75" x2="371.75" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="100.75" y="99.6606">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="113.75" y="99.6606">Register - request</text><path d="M98.75,117.7266 L98.75,278.7266 L353.75,278.7266 L353.75,127.7266 L343.75,117.7266 L98.75,117.7266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M343.75,117.7266 L343.75,127.7266 L353.75,127.7266 L343.75,117.7266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="104.75" y="134.7935">Entry that indicates to Ibeji that</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="104.75" y="149.9263">the Provider wants to utilize the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="104.75" y="165.0591">Managed Subscribe Module.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="104.75" y="180.1919"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="104.75" y="195.3247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="120.75" y="210.4575">protocol: "grpc"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="120.75" y="225.5903">operations: ["ManagedSubscribe"]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="120.75" y="240.7231">uri: "Provider callback uri"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="120.75" y="255.856">context: ""</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="104.75" y="270.9888">}</text><polygon fill="#181818" points="104.75,301.1875,94.75,305.1875,104.75,309.1875,100.75,305.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="98.75" x2="376.75" y1="305.1875" y2="305.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="110.75" y="300.1216">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="123.75" y="300.1216">Register - response</text><polygon fill="#181818" points="104.75,330.3203,94.75,334.3203,104.75,338.3203,100.75,334.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="98.75" x2="376.75" y1="334.3203" y2="334.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="110.75" y="329.2544">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="123.75" y="329.2544">TopicManagementCB (action, payload)</text><path d="M98.75,347.3203 L98.75,568.3203 L322.75,568.3203 L322.75,357.3203 L312.75,347.3203 L98.75,347.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M312.75,347.3203 L312.75,357.3203 L322.75,357.3203 L312.75,347.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="104.75" y="364.3872">Tells provider to start publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="104.75" y="379.52">entity id data on provided topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="104.75" y="394.6528">with the given constraints.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="104.75" y="409.7856"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="104.75" y="424.9185">action: PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="104.75" y="440.0513">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="120.75" y="455.1841">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="120.75" y="470.3169">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="120.75" y="485.4497">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="120.75" y="500.5825">subscription_info: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="136.75" y="515.7153">protocol, // MQTT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="136.75" y="530.8481">uri, // MQTT Broker</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="120.75" y="545.981">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="104.75" y="561.1138">}</text><polygon fill="#181818" points="426.25,591.3125,436.25,595.3125,426.25,599.3125,430.25,595.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="93.75" x2="432.25" y1="595.3125" y2="595.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="100.75" y="590.2466">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="113.75" y="590.2466">data</text><polygon fill="#181818" points="104.75,620.4453,94.75,624.4453,104.75,628.4453,100.75,624.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="98.75" x2="376.75" y1="624.4453" y2="624.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="110.75" y="619.3794">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="123.75" y="619.3794">TopicManagementCB (action, payload)</text><path d="M98.75,637.4453 L98.75,798.4453 L321.75,798.4453 L321.75,647.4453 L311.75,637.4453 L98.75,637.4453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M311.75,637.4453 L311.75,647.4453 L321.75,647.4453 L311.75,637.4453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="104.75" y="654.5122">Tells provider to stop publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="104.75" y="669.645">entity id data on provided topic.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="104.75" y="684.7778"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="104.75" y="699.9106">action: STOP_PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="104.75" y="715.0435">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="120.75" y="730.1763">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="120.75" y="745.3091">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="120.75" y="760.4419">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="120.75" y="775.5747">subscription_info: None,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="104.75" y="790.7075">}</text><line style="stroke:#181818;stroke-width:2.0;" x1="420.25" x2="430.25" y1="819.9063" y2="829.9063"/><line style="stroke:#181818;stroke-width:2.0;" x1="420.25" x2="430.25" y1="829.9063" y2="819.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="93.75" x2="425.25" y1="824.9063" y2="824.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="100.75" y="819.8403">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="113.75" y="819.8403">data</text><line style="stroke:#181818;stroke-width:1.0;" x1="93.75" x2="135.75" y1="854.0391" y2="854.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="135.75" x2="135.75" y1="854.0391" y2="867.0391"/><line style="stroke:#181818;stroke-width:1.0;" x1="94.75" x2="135.75" y1="867.0391" y2="867.0391"/><polygon fill="#181818" points="104.75,863.0391,94.75,867.0391,104.75,871.0391,100.75,867.0391" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="100.75" y="848.9731">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="113.75" y="848.9731">Remove topic mapping</text><!--MD5=[6190b1b981d9cb84636a4c31c760fe6e]
@startuml Managed Subscribe Provider
title Managed Subscribe Sequence from Provider's Perspective
participant "Digital Twin Provider" as DTProvider
participant Ibeji
participant Broker

autonumber

DTProvider -> Ibeji: Register - request
note right of DTProvider
Entry that indicates to Ibeji that
the Provider wants to utilize the
Managed Subscribe Module.

{
    protocol: "grpc"
    operations: ["ManagedSubscribe"]
    uri: "Provider callback uri"
    context: ""
}
end note
Ibeji -> DTProvider: Register - response

Ibeji -> DTProvider: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to start publishing
entity id data on provided topic
with the given constraints.

action: PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: {
        protocol, // MQTT
        uri, // MQTT Broker
    },
}
end note
DTProvider -> Broker: data
DTProvider <- Ibeji: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to stop publishing
entity id data on provided topic.

action: STOP_PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: None,
}
end note
DTProvider ->x Broker: data
DTProvider -> DTProvider: Remove topic mapping
@enduml

PlantUML version 1.2022.7(Mon Aug 22 10:01:30 PDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>