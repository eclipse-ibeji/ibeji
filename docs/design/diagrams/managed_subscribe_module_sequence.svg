<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1356px" preserveAspectRatio="none" style="width:1211px;height:1356px;background:#FEFEFE;" version="1.1" viewBox="0 0 1211 1356" width="1211px" zoomAndPan="magnify"><defs><filter height="300%" id="fjep7lfe1frsp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="301" x="455.75" y="22.9951">Managed Subscribe Module Sequence</text><rect fill="#DDDDDD" height="1311.2344" style="stroke: #A80036; stroke-width: 1.0;" width="390" x="184" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="363.5" y="46.3638">Ibeji</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="86" x2="86" y1="88.7266" y2="1307.2344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="269" x2="269" y1="88.7266" y2="1307.2344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="465" x2="465" y1="88.7266" y2="1307.2344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="774" x2="774" y1="88.7266" y2="1307.2344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="903" x2="903" y1="88.7266" y2="1307.2344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1172.5" x2="1172.5" y1="88.7266" y2="1307.2344"/><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="8" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="15" y="73.4248">Digital Twin Provider</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="8" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="15" y="1326.2295">Digital Twin Provider</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="188" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="195" y="73.4248">InVehicle Digital Twin</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="188" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="195" y="1326.2295">InVehicle Digital Twin</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="360" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="367" y="73.4248">Managed Subscribe Module</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="360" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="367" y="1326.2295">Managed Subscribe Module</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="688" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="695" y="73.4248">Digital Twin Consumer</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="688" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="695" y="1326.2295">Digital Twin Consumer</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="870" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="877" y="73.4248">Agemo</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="870" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="877" y="1326.2295">Agemo</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1140.5" y="53.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1147.5" y="73.4248">Broker</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1140.5" y="1306.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1147.5" y="1326.2295">Broker</text><polygon fill="#A80036" points="280,115.8594,270,119.8594,280,123.8594,276,119.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="274" x2="773" y1="119.8594" y2="119.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="286" y="114.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="299" y="114.7935">FindById (entity_id)</text><polygon fill="#A80036" points="762,144.9922,772,148.9922,762,152.9922,766,148.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="768" y1="148.9922" y2="148.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="276" y="143.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="289" y="143.9263">FindById - response</text><polygon fill="#A80036" points="476,174.125,466,178.125,476,182.125,472,178.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="773" y1="178.125" y2="178.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="482" y="173.0591">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="495" y="173.0591">GetSubscriptionInfo (entity_id, constraints)</text><polygon fill="#A80036" points="891.5,203.2578,901.5,207.2578,891.5,211.2578,895.5,207.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="897.5" y1="207.2578" y2="207.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="202.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="485" y="202.1919">CreateTopic - request</text><polygon fill="#A80036" points="476,232.3906,466,236.3906,476,240.3906,472,236.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="236.3906" y2="236.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="482" y="231.3247">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="495" y="231.3247">CreateTopic - response</text><path d="M470,249.3906 L470,274.3906 L726,274.3906 L726,259.3906 L716,249.3906 L470,249.3906 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M716,249.3906 L716,259.3906 L726,259.3906 L716,249.3906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="476" y="266.4575">SubInfo {topic, broker endpoint info}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="507" y1="304.6563" y2="304.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507" x2="507" y1="304.6563" y2="317.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="507" y1="317.6563" y2="317.6563"/><polygon fill="#A80036" points="476,313.6563,466,317.6563,476,321.6563,472,317.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="299.5903">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="485" y="299.5903">Store entity_id and SubInfo metadata</text><polygon fill="#A80036" points="762,342.7891,772,346.7891,762,350.7891,766,346.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="768" y1="346.7891" y2="346.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="341.7231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="485" y="341.7231">GetSubscriptionInfo - response</text><path d="M509,359.7891 L509,384.7891 L765,384.7891 L765,369.7891 L755,359.7891 L509,359.7891 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M755,359.7891 L755,369.7891 L765,369.7891 L755,359.7891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="515" y="376.856">SubInfo {topic, broker endpoint info}</text><polygon fill="#A80036" points="1160.5,411.0547,1170.5,415.0547,1160.5,419.0547,1164.5,415.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="774" x2="1166.5" y1="415.0547" y2="415.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="781" y="409.9888">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="794" y="409.9888">Subscribe (SubInfo.topic)</text><polygon fill="#A80036" points="914.5,440.1875,904.5,444.1875,914.5,448.1875,910.5,444.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="908.5" x2="1171.5" y1="444.1875" y2="444.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="920.5" y="439.1216">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="933.5" y="439.1216">Sub notification for SubInfo.topic</text><polygon fill="#A80036" points="476,469.3203,466,473.3203,476,477.3203,472,473.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="473.3203" y2="473.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="468.2544">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="504" y="468.2544">ManageTopicCallback (SubInfo.topic, action)</text><polygon fill="#A80036" points="97,498.4531,87,502.4531,97,506.4531,93,502.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="464" y1="502.4531" y2="502.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103" y="497.3872">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="125" y="497.3872">TopicManagementCB (action, payload)</text><path d="M91,515.4531 L91,736.4531 L315,736.4531 L315,525.4531 L305,515.4531 L91,515.4531 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M305,515.4531 L305,525.4531 L315,525.4531 L305,515.4531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="97" y="532.52">Tells provider to start publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="97" y="547.6528">entity id data on provided topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="97" y="562.7856">with the given constraints.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="101" y="577.9185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="97" y="593.0513">action: PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="97" y="608.1841">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="113" y="623.3169">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="113" y="638.4497">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="113" y="653.5825">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="113" y="668.7153">subscription_info: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="129" y="683.8481">protocol, // MQTT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="129" y="698.981">uri, // MQTT Broker</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="113" y="714.1138">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="97" y="729.2466">}</text><polygon fill="#A80036" points="1160.5,763.4453,1170.5,767.4453,1160.5,771.4453,1164.5,767.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="1166.5" y1="767.4453" y2="767.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="762.3794">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="115" y="762.3794">data</text><polygon fill="#A80036" points="785,792.5781,775,796.5781,785,800.5781,781,796.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="779" x2="1171.5" y1="796.5781" y2="796.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="791" y="791.5122">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="813" y="791.5122">data</text><polygon fill="#A80036" points="1160.5,821.7109,1170.5,825.7109,1160.5,829.7109,1164.5,825.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="774" x2="1166.5" y1="825.7109" y2="825.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="781" y="820.645">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="803" y="820.645">Unsubscribe (SubInfo.topic)</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="780" x2="790" y1="849.8438" y2="859.8438"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="780" x2="790" y1="859.8438" y2="849.8438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="786" x2="1171.5" y1="854.8438" y2="854.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="791" y="849.7778">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="813" y="849.7778">data</text><polygon fill="#A80036" points="914.5,879.9766,904.5,883.9766,914.5,887.9766,910.5,883.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="908.5" x2="1171.5" y1="883.9766" y2="883.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="920.5" y="878.9106">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="942.5" y="878.9106">Unsub notification for SubInfo.topic</text><polygon fill="#A80036" points="476,909.1094,466,913.1094,476,917.1094,472,913.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="913.1094" y2="913.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="908.0435">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="504" y="908.0435">ManageTopicCallback (SubInfo.topic, action)</text><polygon fill="#A80036" points="97,938.2422,87,942.2422,97,946.2422,93,942.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="464" y1="942.2422" y2="942.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103" y="937.1763">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="125" y="937.1763">TopicManagementCB (action, payload)</text><path d="M91,955.2422 L91,1116.2422 L314,1116.2422 L314,965.2422 L304,955.2422 L91,955.2422 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M304,955.2422 L304,965.2422 L314,965.2422 L304,955.2422 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="97" y="972.3091">Tells provider to stop publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="97" y="987.4419">entity id data on provided topic.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="101" y="1002.5747"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="97" y="1017.7075">action: STOP_PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="97" y="1032.8403">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="113" y="1047.9731">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="113" y="1063.106">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="113" y="1078.2388">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="113" y="1093.3716">subscription_info: None,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="97" y="1108.5044">}</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="1154.5" x2="1164.5" y1="1141.7031" y2="1151.7031"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1154.5" x2="1164.5" y1="1151.7031" y2="1141.7031"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="1159.5" y1="1146.7031" y2="1146.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="1141.6372">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="115" y="1141.6372">data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="128" y1="1175.8359" y2="1175.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="128" x2="128" y1="1175.8359" y2="1188.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87" x2="128" y1="1188.8359" y2="1188.8359"/><polygon fill="#A80036" points="97,1184.8359,87,1188.8359,97,1192.8359,93,1188.8359" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="1170.77">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="115" y="1170.77">Remove topic mapping</text><polygon fill="#A80036" points="891.5,1213.9688,901.5,1217.9688,891.5,1221.9688,895.5,1217.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="897.5" y1="1217.9688" y2="1217.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="472" y="1212.9028">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="494" y="1212.9028">DeleteTopic (SubInfo.topic)</text><polygon fill="#A80036" points="476,1243.1016,466,1247.1016,476,1251.1016,472,1247.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="1247.1016" y2="1247.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="1242.0356">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="504" y="1242.0356">DeleteTopic - response</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="507" y1="1276.2344" y2="1276.2344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507" x2="507" y1="1276.2344" y2="1289.2344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="507" y1="1289.2344" y2="1289.2344"/><polygon fill="#A80036" points="476,1285.2344,466,1289.2344,476,1293.2344,472,1289.2344" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="472" y="1271.1685">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="494" y="1271.1685">Remove topic mapping</text><!--
@startuml
skinparamlocked backgroundColor fefefe
title Managed Subscribe Module Sequence
participant "Digital Twin Provider" as DTProvider
box "Ibeji"
participant "InVehicle Digital Twin" as Ibeji
participant "Managed Subscribe Module" as ManagedSubscribeModule
end box
participant "Digital Twin Consumer" as DTConsumer
participant Agemo
participant Broker

autonumber

DTConsumer -> Ibeji: FindById (entity_id)
DTConsumer <- Ibeji: FindById - response
DTConsumer -> ManagedSubscribeModule: GetSubscriptionInfo (entity_id, constraints)
ManagedSubscribeModule -> Agemo: CreateTopic - request
Agemo -> ManagedSubscribeModule: CreateTopic - response
note right of ManagedSubscribeModule: SubInfo {topic, broker endpoint info}
ManagedSubscribeModule -> ManagedSubscribeModule: Store entity_id and SubInfo metadata
ManagedSubscribeModule -> DTConsumer: GetSubscriptionInfo - response
note left of DTConsumer: SubInfo {topic, broker endpoint info}
DTConsumer -> Broker: Subscribe (SubInfo.topic)
Broker -> Agemo: Sub notification for SubInfo.topic
Agemo -> ManagedSubscribeModule: ManageTopicCallback (SubInfo.topic, action)
ManagedSubscribeModule -> DTProvider: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to start publishing
entity id data on provided topic
with the given constraints.

action: PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: {
        protocol, // MQTT
        uri, // MQTT Broker
    },
}
end note
DTProvider -> Broker: data
DTConsumer <- Broker : data
DTConsumer -> Broker: Unsubscribe (SubInfo.topic)
DTConsumer x<- Broker: data
Broker -> Agemo: Unsub notification for SubInfo.topic
Agemo -> ManagedSubscribeModule: ManageTopicCallback (SubInfo.topic, action)
DTProvider <- ManagedSubscribeModule: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to stop publishing
entity id data on provided topic.

action: STOP_PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: None,
}
end note
DTProvider ->x Broker: data
DTProvider -> DTProvider: Remove topic mapping
ManagedSubscribeModule -> Agemo: DeleteTopic (SubInfo.topic)
ManagedSubscribeModule <- Agemo: DeleteTopic - response
ManagedSubscribeModule -> ManagedSubscribeModule: Remove topic mapping
@enduml

PlantUML version 1.2018.13(Mon Nov 26 09:11:51 PST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.21+9-post-Ubuntu-0ubuntu120.04
Operating System: Linux
OS Version: 5.4.0-171-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>