<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1361px" preserveAspectRatio="none" style="width:1211px;height:1361px;background:#FEFEFE;" version="1.1" viewBox="0 0 1211 1361" width="1211px" zoomAndPan="magnify"><defs><filter height="300%" id="fjep7lfe1frsp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="334" x="439.25" y="26.708">Managed Subscribe Module Sequence</text><rect fill="#DDDDDD" height="1311.2344" style="stroke: #A80036; stroke-width: 1.0;" width="390" x="184" y="38.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="363.5" y="51.02">Ibeji</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="86" x2="86" y1="93.3828" y2="1311.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="269" x2="269" y1="93.3828" y2="1311.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="465" x2="465" y1="93.3828" y2="1311.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="774" x2="774" y1="93.3828" y2="1311.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="903" x2="903" y1="93.3828" y2="1311.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1172.5" x2="1172.5" y1="93.3828" y2="1311.8906"/><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="8" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="15" y="78.0811">Digital Twin Provider</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="8" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="15" y="1330.8857">Digital Twin Provider</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="188" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="195" y="78.0811">InVehicle Digital Twin</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="188" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="195" y="1330.8857">InVehicle Digital Twin</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="360" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="367" y="78.0811">Managed Subscribe Module</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="360" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="367" y="1330.8857">Managed Subscribe Module</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="688" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="695" y="78.0811">Digital Twin Consumer</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="688" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="695" y="1330.8857">Digital Twin Consumer</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="870" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="877" y="78.0811">Agemo</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="870" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="877" y="1330.8857">Agemo</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1140.5" y="58.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1147.5" y="78.0811">Broker</text><rect fill="#FEFECE" filter="url(#fjep7lfe1frsp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1140.5" y="1310.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1147.5" y="1330.8857">Broker</text><polygon fill="#A80036" points="280,120.5156,270,124.5156,280,128.5156,276,124.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="274" x2="773" y1="124.5156" y2="124.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="286" y="119.4497">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="299" y="119.4497">FindById (entity_id)</text><polygon fill="#A80036" points="762,149.6484,772,153.6484,762,157.6484,766,153.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="768" y1="153.6484" y2="153.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="276" y="148.5825">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="289" y="148.5825">FindById - response</text><polygon fill="#A80036" points="476,178.7813,466,182.7813,476,186.7813,472,182.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="773" y1="182.7813" y2="182.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="482" y="177.7153">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="495" y="177.7153">GetSubscriptionInfo (entity_id, constraints)</text><polygon fill="#A80036" points="891.5,207.9141,901.5,211.9141,891.5,215.9141,895.5,211.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="897.5" y1="211.9141" y2="211.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="206.8481">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="485" y="206.8481">CreateTopic - request</text><polygon fill="#A80036" points="476,237.0469,466,241.0469,476,245.0469,472,241.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="241.0469" y2="241.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="482" y="235.981">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="495" y="235.981">CreateTopic - response</text><path d="M470,254.0469 L470,279.0469 L726,279.0469 L726,264.0469 L716,254.0469 L470,254.0469 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M716,254.0469 L716,264.0469 L726,264.0469 L716,254.0469 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="476" y="271.1138">SubInfo {topic, broker endpoint info}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="507" y1="309.3125" y2="309.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507" x2="507" y1="309.3125" y2="322.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="507" y1="322.3125" y2="322.3125"/><polygon fill="#A80036" points="476,318.3125,466,322.3125,476,326.3125,472,322.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="304.2466">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="485" y="304.2466">Store entity_id and SubInfo metadata</text><polygon fill="#A80036" points="762,347.4453,772,351.4453,762,355.4453,766,351.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="768" y1="351.4453" y2="351.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="472" y="346.3794">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="485" y="346.3794">GetSubscriptionInfo - response</text><path d="M509,364.4453 L509,389.4453 L765,389.4453 L765,374.4453 L755,364.4453 L509,364.4453 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M755,364.4453 L755,374.4453 L765,374.4453 L755,364.4453 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="515" y="381.5122">SubInfo {topic, broker endpoint info}</text><polygon fill="#A80036" points="1160.5,415.7109,1170.5,419.7109,1160.5,423.7109,1164.5,419.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="774" x2="1166.5" y1="419.7109" y2="419.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="781" y="414.645">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="794" y="414.645">Subscribe (SubInfo.topic)</text><polygon fill="#A80036" points="914.5,444.8438,904.5,448.8438,914.5,452.8438,910.5,448.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="908.5" x2="1171.5" y1="448.8438" y2="448.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="920.5" y="443.7778">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="933.5" y="443.7778">Sub notification for SubInfo.topic</text><polygon fill="#A80036" points="476,473.9766,466,477.9766,476,481.9766,472,477.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="477.9766" y2="477.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="472.9106">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="504" y="472.9106">ManageTopicCallback (SubInfo.topic, action)</text><polygon fill="#A80036" points="97,503.1094,87,507.1094,97,511.1094,93,507.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="464" y1="507.1094" y2="507.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103" y="502.0435">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="125" y="502.0435">TopicManagementCB (action, payload)</text><path d="M91,520.1094 L91,741.1094 L315,741.1094 L315,530.1094 L305,520.1094 L91,520.1094 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M305,520.1094 L305,530.1094 L315,530.1094 L305,520.1094 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="97" y="537.1763">Tells provider to start publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="97" y="552.3091">entity id data on provided topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="97" y="567.4419">with the given constraints.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="101" y="582.5747"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="97" y="597.7075">action: PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="97" y="612.8403">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="113" y="627.9731">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="113" y="643.106">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="113" y="658.2388">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="113" y="673.3716">subscription_info: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="129" y="688.5044">protocol, // MQTT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="129" y="703.6372">uri, // MQTT Broker</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="113" y="718.77">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="97" y="733.9028">}</text><polygon fill="#A80036" points="1160.5,768.1016,1170.5,772.1016,1160.5,776.1016,1164.5,772.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="1166.5" y1="772.1016" y2="772.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="767.0356">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="115" y="767.0356">data</text><polygon fill="#A80036" points="785,797.2344,775,801.2344,785,805.2344,781,801.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="779" x2="1171.5" y1="801.2344" y2="801.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="791" y="796.1685">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="813" y="796.1685">data</text><polygon fill="#A80036" points="1160.5,826.3672,1170.5,830.3672,1160.5,834.3672,1164.5,830.3672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="774" x2="1166.5" y1="830.3672" y2="830.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="781" y="825.3013">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="803" y="825.3013">Unsubscribe (SubInfo.topic)</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="780" x2="790" y1="854.5" y2="864.5"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="780" x2="790" y1="864.5" y2="854.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="786" x2="1171.5" y1="859.5" y2="859.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="791" y="854.4341">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="813" y="854.4341">data</text><polygon fill="#A80036" points="914.5,884.6328,904.5,888.6328,914.5,892.6328,910.5,888.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="908.5" x2="1171.5" y1="888.6328" y2="888.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="920.5" y="883.5669">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="942.5" y="883.5669">Unsub notification for SubInfo.topic</text><polygon fill="#A80036" points="476,913.7656,466,917.7656,476,921.7656,472,917.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="917.7656" y2="917.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="912.6997">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="504" y="912.6997">ManageTopicCallback (SubInfo.topic, action)</text><polygon fill="#A80036" points="97,942.8984,87,946.8984,97,950.8984,93,946.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="464" y1="946.8984" y2="946.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103" y="941.8325">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="125" y="941.8325">TopicManagementCB (action, payload)</text><path d="M91,959.8984 L91,1120.8984 L314,1120.8984 L314,969.8984 L304,959.8984 L91,959.8984 " fill="#FBFB77" filter="url(#fjep7lfe1frsp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M304,959.8984 L304,969.8984 L314,969.8984 L304,959.8984 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="97" y="976.9653">Tells provider to stop publishing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="97" y="992.0981">entity id data on provided topic.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="101" y="1007.231"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="97" y="1022.3638">action: STOP_PUBLISH</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="97" y="1037.4966">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="113" y="1052.6294">entity_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="113" y="1067.7622">topic,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="113" y="1082.895">constraints, // (type, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="113" y="1098.0278">subscription_info: None,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="97" y="1113.1606">}</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="1154.5" x2="1164.5" y1="1146.3594" y2="1156.3594"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1154.5" x2="1164.5" y1="1156.3594" y2="1146.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="1159.5" y1="1151.3594" y2="1151.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="1146.2935">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="115" y="1146.2935">data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="86" x2="128" y1="1180.4922" y2="1180.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="128" x2="128" y1="1180.4922" y2="1193.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87" x2="128" y1="1193.4922" y2="1193.4922"/><polygon fill="#A80036" points="97,1189.4922,87,1193.4922,97,1197.4922,93,1193.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93" y="1175.4263">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="115" y="1175.4263">Remove topic mapping</text><polygon fill="#A80036" points="891.5,1218.625,901.5,1222.625,891.5,1226.625,895.5,1222.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="897.5" y1="1222.625" y2="1222.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="472" y="1217.5591">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="494" y="1217.5591">DeleteTopic (SubInfo.topic)</text><polygon fill="#A80036" points="476,1247.7578,466,1251.7578,476,1255.7578,472,1251.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470" x2="902.5" y1="1251.7578" y2="1251.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="1246.6919">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="504" y="1246.6919">DeleteTopic - response</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="465" x2="507" y1="1280.8906" y2="1280.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="507" x2="507" y1="1280.8906" y2="1293.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="507" y1="1293.8906" y2="1293.8906"/><polygon fill="#A80036" points="476,1289.8906,466,1293.8906,476,1297.8906,472,1293.8906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="472" y="1275.8247">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="494" y="1275.8247">Remove topic mapping</text><!--MD5=[79306678c11d1c6f30212306d32e829d]
@startuml
skinparamlocked backgroundColor fefefe
title Managed Subscribe Module Sequence
participant "Digital Twin Provider" as DTProvider
box "Ibeji"
participant "InVehicle Digital Twin" as Ibeji
participant "Managed Subscribe Module" as ManagedSubscribeModule
end box
participant "Digital Twin Consumer" as DTConsumer
participant Agemo
participant Broker

autonumber

DTConsumer -> Ibeji: FindById (entity_id)
DTConsumer <- Ibeji: FindById - response
DTConsumer -> ManagedSubscribeModule: GetSubscriptionInfo (entity_id, constraints)
ManagedSubscribeModule -> Agemo: CreateTopic - request
Agemo -> ManagedSubscribeModule: CreateTopic - response
note right of ManagedSubscribeModule: SubInfo {topic, broker endpoint info}
ManagedSubscribeModule -> ManagedSubscribeModule: Store entity_id and SubInfo metadata
ManagedSubscribeModule -> DTConsumer: GetSubscriptionInfo - response
note left of DTConsumer: SubInfo {topic, broker endpoint info}
DTConsumer -> Broker: Subscribe (SubInfo.topic)
Broker -> Agemo: Sub notification for SubInfo.topic
Agemo -> ManagedSubscribeModule: ManageTopicCallback (SubInfo.topic, action)
ManagedSubscribeModule -> DTProvider: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to start publishing
entity id data on provided topic
with the given constraints.

action: PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: {
        protocol, // MQTT
        uri, // MQTT Broker
    },
}
end note
DTProvider -> Broker: data
DTConsumer <- Broker : data
DTConsumer -> Broker: Unsubscribe (SubInfo.topic)
DTConsumer x<- Broker: data
Broker -> Agemo: Unsub notification for SubInfo.topic
Agemo -> ManagedSubscribeModule: ManageTopicCallback (SubInfo.topic, action)
DTProvider <- ManagedSubscribeModule: TopicManagementCB (action, payload)
note right of DTProvider
Tells provider to stop publishing
entity id data on provided topic.

action: STOP_PUBLISH
payload: {
    entity_id,
    topic,
    constraints, // (type, value)
    subscription_info: None,
}
end note
DTProvider ->x Broker: data
DTProvider -> DTProvider: Remove topic mapping
ManagedSubscribeModule -> Agemo: DeleteTopic (SubInfo.topic)
ManagedSubscribeModule <- Agemo: DeleteTopic - response
ManagedSubscribeModule -> ManagedSubscribeModule: Remove topic mapping
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.22+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>