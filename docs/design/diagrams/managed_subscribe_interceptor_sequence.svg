<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="640px" preserveAspectRatio="none" style="width:679px;height:640px;background:#FFFFFF;" version="1.1" viewBox="0 0 679 640" width="679px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="343" x="167.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="333" x="172.25" y="27.9951">Managed Subscribe Interceptor Sequence</text><rect fill="none" height="368.3906" style="stroke:#000000;stroke-width:1.5;" width="582" x="76" y="161.8594"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="81" x2="81" y1="73.5938" y2="605.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="270" x2="270" y1="73.5938" y2="605.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="652.5" x2="652.5" y1="73.5938" y2="605.5156"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="12" y="62.292">Digital Twin Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="5" y="604.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="12" y="624.5107">Digital Twin Provider</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="206" x="167" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="174" y="62.292">Managed Subscribe Module</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="206" x="167" y="604.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="174" y="624.5107">Managed Subscribe Module</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="632.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="639.5" y="62.292">Ibeji</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="632.5" y="604.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="639.5" y="624.5107">Ibeji</text><polygon fill="#181818" points="258,100.7266,268,104.7266,258,108.7266,262,104.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="81" x2="264" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="88" y="99.6606">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="101" y="99.6606">Register - request</text><line style="stroke:#181818;stroke-width:1.0;" x1="270" x2="312" y1="133.8594" y2="133.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="312" x2="312" y1="133.8594" y2="146.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="271" x2="312" y1="146.8594" y2="146.8594"/><polygon fill="#181818" points="281,142.8594,271,146.8594,281,150.8594,277,146.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="277" y="128.7935">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="290" y="128.7935">Intercepts Register request</text><path d="M76,161.8594 L140,161.8594 L140,168.9922 L130,178.9922 L76,178.9922 L76,161.8594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="368.3906" style="stroke:#000000;stroke-width:1.5;" width="582" x="76" y="161.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="91" y="174.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="240" x="155" y="174.0698">[contains `ManagedSubscribe` Entry]</text><path d="M86,183.9922 L86,314.9922 L423,314.9922 L423,193.9922 L413,183.9922 L86,183.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M413,183.9922 L413,193.9922 L423,193.9922 L413,183.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="92" y="201.0591">// Entry that indicates to Ibeji that the Provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="92" y="216.1919">// wants to utilize the Managed Subscribe Module.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="92" y="231.3247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="108" y="246.4575">protocol: "grpc"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="108" y="261.5903">operations: ["ManagedSubscribe"]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="108" y="276.7231">uri: "Provider callback uri"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="108" y="291.856">context: ""</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="92" y="306.9888">}</text><line style="stroke:#181818;stroke-width:1.0;" x1="270" x2="312" y1="341.1875" y2="341.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="312" x2="312" y1="341.1875" y2="354.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="271" x2="312" y1="354.1875" y2="354.1875"/><polygon fill="#181818" points="281,350.1875,271,354.1875,281,358.1875,277,354.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="277" y="336.1216">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="290" y="336.1216">Store provider callback.</text><line style="stroke:#181818;stroke-width:1.0;" x1="270" x2="312" y1="383.3203" y2="383.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="312" x2="312" y1="383.3203" y2="396.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="271" x2="312" y1="396.3203" y2="396.3203"/><polygon fill="#181818" points="281,392.3203,271,396.3203,281,400.3203,277,396.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="277" y="378.2544">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="290" y="378.2544">Modify the request's `ManagedSubscribe` endpointInfo.</text><path d="M275,409.3203 L275,524.3203 L616,524.3203 L616,419.3203 L606,409.3203 L275,409.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M606,409.3203 L606,419.3203 L616,419.3203 L606,409.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320" x="281" y="426.3872">// Points to the Managed Subscribe gRPC endpoint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="281" y="441.52">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="297" y="456.6528">protocol: "grpc"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="297" y="471.7856">operations: ["ManagedSubscribe"]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="297" y="486.9185">uri: "Ibeji uri"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="297" y="502.0513">context: "GetSubscriptionInfo"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="281" y="517.1841">}</text><polygon fill="#181818" points="641,554.3828,651,558.3828,641,562.3828,645,558.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="270" x2="647" y1="558.3828" y2="558.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="277" y="553.3169">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="290" y="553.3169">Passes on Register request</text><polygon fill="#181818" points="92,583.5156,82,587.5156,92,591.5156,88,587.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86" x2="652" y1="587.5156" y2="587.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="98" y="582.4497">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="111" y="582.4497">Register - response</text><!--MD5=[043644b7914819e1a8557775d7c457fe]
@startuml Managed Subscribe Interceptor
title Managed Subscribe Interceptor Sequence
participant "Digital Twin Provider" as DTProvider
participant "Managed Subscribe Module" as ManagedSubscribeModule
participant Ibeji

autonumber

DTProvider -> ManagedSubscribeModule: Register - request
ManagedSubscribeModule -> ManagedSubscribeModule: Intercepts Register request

alt contains `ManagedSubscribe` Entry
note right of DTProvider
// Entry that indicates to Ibeji that the Provider
// wants to utilize the Managed Subscribe Module.
{
    protocol: "grpc"
    operations: ["ManagedSubscribe"]
    uri: "Provider callback uri"
    context: ""
}
end note
ManagedSubscribeModule -> ManagedSubscribeModule: Store provider callback.
ManagedSubscribeModule -> ManagedSubscribeModule: Modify the request's `ManagedSubscribe` endpointInfo.
note right of ManagedSubscribeModule
// Points to the Managed Subscribe gRPC endpoint
{
    protocol: "grpc"
    operations: ["ManagedSubscribe"]
    uri: "Ibeji uri"
    context: "GetSubscriptionInfo"
}
end note
end

Ibeji <- ManagedSubscribeModule: Passes on Register request
Ibeji -> DTProvider: Register - response
@enduml

PlantUML version 1.2022.7(Mon Aug 22 10:01:30 PDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>